I"Ïi<h2 id="androidå¼•å…¥kotlin">Androidå¼•å…¥Kotlin</h2>

<h3 id="1å¼•å…¥åŸå› ">1ã€å¼•å…¥åŸå› </h3>
<h4 id="11-kotlinçš„ä¼˜ç‚¹">1.1 kotlinçš„ä¼˜ç‚¹</h4>
<ul>
  <li>æ›´å°‘çš„ç©ºæŒ‡é’ˆå¼‚å¸¸</li>
  <li>æ›´å°‘çš„ä»£ç é‡</li>
  <li>æ›´å¿«çš„å¼€å‘é€Ÿåº¦</li>
  <li>ä¸€è‡´çš„å¼€å‘ä½“éªŒ</li>
</ul>

<h4 id="12-ç©ºå®‰å…¨">1.2 ç©ºå®‰å…¨</h4>
<p>åœ¨Q3å­£åº¦çš„å´©æºƒæ±‡ä¸­ï¼Œjava.lang.NullPointerExceptionå åˆ°äº†73%ï¼Œkotlinå¯ä»¥æ¯”è¾ƒä¼˜é›…çš„å¤„ç†åˆ¤ç©ºé—®é¢˜ï¼Œé¿å…ä¸€å †ifåˆ¤ç©ºçš„ä»£ç ã€‚</p>

<ul>
  <li>
    <p>å®šä¹‰ä¸€ä¸ªå¯ç©ºç±»å‹çš„å˜é‡æˆ–æ–¹æ³•</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre>  var a : Int = 12 //aä¸å¯ä¸ºç©º  a=nullä¼šæŠ¥é”™
	
  var b : Stringï¼Ÿ = 12// ä½¿ç”¨bå˜é‡æ—¶ä¼šæç¤ºä½ éœ€è¦è¿›è¡Œç©ºåˆ¤æ–­
	
  fun funNullMethod() : Int? {
  val str : String? = "123456"
  return str?.length
  }
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
</ul>

<h4 id="åˆ¤ç©ºçš„å¸¸ç”¨æ–¹å¼æœ‰---let">åˆ¤ç©ºçš„å¸¸ç”¨æ–¹å¼æœ‰ ?. !!. let</h4>
<h4>?.</h4>

<p>è¯¥ç¬¦å·çš„ç”¨æ³•ä¸ºï¼šå¯ç©ºç±»å‹å˜é‡?.å±æ€§/æ–¹æ³•ã€‚å¦‚æœå¯ç©ºç±»å‹å˜é‡ä¸ºnullæ—¶ï¼Œè¿”å›null</p>

<p>è¿™ç§ç”¨æ³•å¤§é‡ç”¨äºé“¾å¼æ“ä½œçš„ç”¨æ³•ä¸­ï¼Œèƒ½æœ‰æ•ˆé¿å…ç©ºå¼•ç”¨å¼‚å¸¸ï¼ˆNullPointExceptionï¼‰ï¼Œå› ä¸ºåªè¦é“¾å¼å…¶ä¸­çš„ä¸€ä¸ªä¸ºnullï¼Œåˆ™æ•´ä¸ªè¡¨è¾¾å¼éƒ½ä¸ºnull</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre>//java å†™æ³•
ifï¼ˆitem != nullï¼‰{
	item.isRecord = true;
	if(item.user != null){
		tv.setText(item.user.name);
	}
}

//kotlinå†™æ³•  
item?.isRecord = true
tv.setText(item?.user?.name)
</pre></td></tr></tbody></table></code></pre></div></div>

<h4 id="-1">!!.</h4>
<p>!!æ“ä½œç¬¦å¯è°“æ˜¯ç»™çˆ±å¥½ç©ºå¼•ç”¨å¼‚å¸¸ï¼ˆNullPointExceptionï¼‰çš„å¼€å‘è€…ä½¿ç”¨ï¼Œå› ä¸ºåœ¨ä½¿ç”¨ä¸€ä¸ªå¯ç©ºç±»å‹å˜é‡æ—¶ï¼Œåœ¨è¯¥å˜é‡åé¢åŠ ä¸Š!!æ“ä½œç¬¦ï¼Œä¼šæ˜¾ç¤ºçš„æŠ›å‡ºNullPointExceptionå¼‚å¸¸</p>

<h4 id="let">let</h4>
<p>letæ“ä½œç¬¦çš„ä½œç”¨ï¼šå½“æ—¶ç”¨ç¬¦å·?.éªŒè¯çš„æ—¶å€™å¿½ç•¥æ‰null</p>

<p>letçš„ç”¨æ³•ï¼šå˜é‡?.let{ â€¦ }</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="rouge-code"><pre>val arrTest : Array&lt;Int?&gt; = arrayOf(1,2,null,3,null,5,6,null)
// ä¼ ç»Ÿå†™æ³•
for (index in arrTest) {
    if (index == null){
        continue
    }
    println("index =&gt; $index")
}

// letå†™æ³•
for (index in arrTest) {
    index?.let { println("index =&gt; $it") }
}
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="2å¼•å…¥kotlin">2ã€å¼•å…¥kotlin</h3>
<h4 id="21å¼•å…¥æ–¹å¼">2.1ã€å¼•å…¥æ–¹å¼</h4>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre></td><td class="rouge-code"><pre>//åœ¨projectä¸‹çš„build.gradleä¸­æ·»åŠ 
buildscript {
    ext.kotlin_version = '1.3.50'
	...
   }

    dependencies {
       ...
        classpath "org.jetbrains.kotlin:kotlin-gradle-plugin:$kotlin_version"
    }
}

//åœ¨common moduleä¸‹çš„build.gradleä¸­æ·»åŠ 
    api "org.jetbrains.kotlin:kotlin-stdlib-jdk7:$kotlin_version"

//åœ¨appçš„build.gradleä¸­æ·»åŠ 
apply plugin: 'kotlin-android'


//åœ¨éœ€è¦ç›´æ¥ä½¿ç”¨å¸ƒå±€view Idçš„æ¨¡å—ä¸‹çš„build.gradleä¸­æ·»åŠ 
apply plugin: 'kotlin-android-extensions'
</pre></td></tr></tbody></table></code></pre></div></div>

<h4 id="22ä½¿ç”¨kotlinå¼€å‘æ–°åŠŸèƒ½">2.2ã€ä½¿ç”¨kotlinå¼€å‘æ–°åŠŸèƒ½</h4>

<p>æˆ‘çš„è¯„è®ºä¸å›å¤æˆ‘çš„åŠŸèƒ½å·²ç»ä½¿ç”¨kotlinå¼€å‘</p>

<h3 id="3ä½¿ç”¨æ³¨æ„">3ã€ä½¿ç”¨æ³¨æ„</h3>
<h4 id="31kotlin-android-extensions">3.1ã€kotlin-android-extensions</h4>
<p>kotlin-android-extensions æ˜¯ç”¨æ¥æ›¿ä»£findViewByIdçš„æ’ä»¶ï¼Œå‡è®¾æœ‰ä¸€ä¸ªå¸ƒå±€æ–‡ä»¶ activity_mainï¼Œé‚£ä¹ˆåœ¨Activityç±»é‡Œé¢ï¼Œåªéœ€è¦æŠŠå¸ƒå±€æ–‡ä»¶importè¿›å»å³å¯ï¼Œimportä¹‹åç›´æ¥æ ¹æ®æ§ä»¶çš„idå³å¯è¿›è¡ŒUIæ“ä½œï¼Œå¦‚ä¸‹ï¼š</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="rouge-code"><pre>//åœ¨éœ€è¦ç›´æ¥ä½¿ç”¨å¸ƒå±€view Idçš„æ¨¡å—ä¸‹çš„build.gradleä¸­æ·»åŠ 
apply plugin: 'kotlin-android-extensions'

//java
TextView tv_title = findViewById(R.id.tv_title);
TextView tv_confirm = findViewById(R.id.tv_confirm);
tv_title.setText("æˆ‘çš„è¯„è®º");
tv_confirm.setText("ç¡®å®š");

//kotlin
import kotlinx.android.synthetic.main.activity_main.* //è¿™ä¸ªæ˜¯è‡ªåŠ¨å¯¼å…¥çš„
tv_title.setText("æˆ‘çš„è¯„è®º")
tv_confirm.setText("ç¡®å®š")
</pre></td></tr></tbody></table></code></pre></div></div>

<h4 id="32kotlin-kapt">3.2ã€kotlin-kapt</h4>

<p>å¦‚æœä½ çš„Kotlinä»£ç é‡Œé¢æœ‰ä½¿ç”¨åˆ°æ³¨è§£ï¼Œé‚£ä¹ˆéœ€è¦åŠ å…¥è¿™ä¸ªæ’ä»¶ï¼ˆkapt å³ Kotlin annotation processing toolï¼ŒKotlin æ³¨è§£å¤„ç†å·¥å…·çš„ç¼©å†™ï¼‰ éœ€è¦å¯¹æ³¨è§£çš„æ”¯æŒannotationProcessoræ›¿æ¢æˆkapt</p>

<p>kaptæ³¨è§£å¤„ç†ä»»åŠ¡å¹¶æ²¡æœ‰åˆ©ç”¨å¼€å¯gradleçš„æ„å»ºç¼“å­˜ï¼Œéœ€è¦æˆ‘ä»¬æ‰‹åŠ¨å¢åŠ é…ç½®å¼€å¯
å¼€å¯æ–¹å¼ï¼šåœ¨é¡¹ç›®çš„app moduleä¸‹çš„ build.gradle æ–‡ä»¶å¢åŠ å¦‚ä¸‹ä»£ç </p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre>apply plugin: 'kotlin-kapt'

kapt {
    useBuildCache = true
}
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="å­—ç¬¦ä¸²æ‹¼æ¥">å­—ç¬¦ä¸²æ‹¼æ¥</h3>
<ul>
  <li>æ›´ç®€æ´çš„å­—ç¬¦ä¸²</li>
  <li>å¼•å…¥äº†å­—ç¬¦ä¸²æ¨¡ç‰ˆ</li>
</ul>

<p>åŠ å…¥äº†ä¸‰ä¸ªå¼•å·â€"â€æ¥æ–¹ä¾¿é•¿ç¯‡å­—ç¬¦çš„ç¼–å†™</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre>	String str2 = "line1\n" +
	                "line2\n" +
	                "line3";
            
    val str2 = """
				line1
		        line2
		        line3
		        """
</pre></td></tr></tbody></table></code></pre></div></div>

<p>åŒæ—¶ï¼ŒKotlinä¸­å¼•å…¥äº†å­—ç¬¦ä¸²æ¨¡ç‰ˆï¼Œæ–¹ä¾¿å­—ç¬¦ä¸²çš„æ‹¼æ¥ï¼Œå¯ä»¥ç”¨$ç¬¦å·æ‹¼æ¥å˜é‡å’Œè¡¨è¾¾å¼</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre>fun testString2() {
    val strings = arrayListOf("abc", "efd", "gfg")
    println("First content is $strings")
    println("First content is ${strings[0]}")
    println("First content is ${if (strings.size &gt; 0) strings[0] else "null"}")
}
</pre></td></tr></tbody></table></code></pre></div></div>

<h4 id="33-å…¨å±€å˜é‡çš„ä½¿ç”¨">3.3 å…¨å±€å˜é‡çš„ä½¿ç”¨</h4>
<p>å…¨å±€å˜é‡éœ€è¦ä½¿ç”¨ companion objectåŒ…è£¹èµ·æ¥ï¼Œå¦åˆ™ä¼šæ— æ³•å¼•ç”¨</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre>companion object{
val TYPE_MY_COMMENT = 1
val TYPE_MY_COMMENT_REPLY = 2
}
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="å¸¸é‡å’Œé™æ€æ–¹æ³•">å¸¸é‡å’Œé™æ€æ–¹æ³•</h3>

<h4 id="å¸¸é‡">å¸¸é‡</h4>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre></td><td class="rouge-code"><pre>Javaä¸­ï¼š
   class StaticDemoActivity {
         public static final String LOAN_TYPE = "loanType";
         public static final String LOAN_TITLE = "loanTitle";
    }
Kotlinä¸­ï¼š
  class StaticDemoActivity {
  companion object {
       val  LOAN_TYPE = "loanType"
       val  LOAN_TITLE = "loanTitle"
}

æˆ–è€…

  class StaticDemoActivity {
      companion object StaticParams{
            val  LOAN_TYPE = "loanType"
            val  LOAN_TITLE = "loanTitle"
    }
}
æˆ–è€…
  class StaticDemoActivity {
      companion object {
         const val LOAN_TYPE = "loanType"
         const val LOAN_TITLE = "loanTitle"
    }
} æ³¨ï¼šconst å…³é”®å­—ç”¨æ¥ä¿®é¥°å¸¸é‡ï¼Œä¸”åªèƒ½ä¿®é¥° valï¼Œä¸èƒ½ä¿®é¥°var, companion object çš„åå­—å¯ä»¥çœç•¥ï¼Œå¯ä»¥ä½¿ç”¨ Companionæ¥æŒ‡ä»£
</pre></td></tr></tbody></table></code></pre></div></div>

<p>å¼•ç”¨å¸¸é‡ï¼ˆè¿™é‡Œçš„å¼•ç”¨åªé’ˆå¯¹äºjavaå¼•ç”¨kotlinä»£ç ï¼‰</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre></td><td class="rouge-code"><pre>TestEntityç±»å¼•ç”¨StaticDemoActivityä¸­çš„å¸¸é‡

   class TestEntity {
        public TestEntity () {
            String title = StaticDemoActivity.Companion.getLOAN_TITLE();
    }
  }

  æˆ–è€…

  class TestEntity {
        public TestEntity () {
            String title = StaticDemoActivity.StaticParams.getLOAN_TITLE();
        }
  }

  æˆ–è€…

  class TestEntity {
        public TestEntity () {
            String title = StaticDemoActivity.LOAN_TITLE;
            String type= StaticDemoActivity.LOAN_TYPE;
        }
  }
</pre></td></tr></tbody></table></code></pre></div></div>

<h4 id="é™æ€æ–¹æ³•">é™æ€æ–¹æ³•</h4>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre></td><td class="rouge-code"><pre>Javaä»£ç ï¼š
      class StaticDemoActivity {
          public static void test(){
                ã€ã€ã€
          } 
      }
Kotlinä¸­ï¼š
      class StaticDemoActivity {
          companion object {
               fun test(){
                    ã€ã€ã€
                }
          }
      }

  æˆ–è€…

       class StaticDemoActivity {
          companion object StaticParams{
              fun test() {
                  ã€ã€ã€
              }
          }
      }
</pre></td></tr></tbody></table></code></pre></div></div>

<p>å¼•ç”¨é™æ€æ–¹æ³•ï¼ˆè¿™é‡Œçš„å¼•ç”¨åªé’ˆå¯¹äºjavaå¼•ç”¨kotlinä»£ç ï¼‰</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td><td class="rouge-code"><pre>TestEntityç±»å¼•ç”¨StaticDemoActivityä¸­çš„é™æ€æ–¹æ³•

    class TestEntity {
          public TestEntity () {
                StaticDemoActivity.Companion.test();
          }
    }

æˆ–è€…

    class TestEntity {
          public TestEntity () {
             StaticDemoActivity.StaticParams.test();
          }
    } companion object {}ä¸­ç”¨æ¥ä¿®é¥° é™æ€å¸¸é‡ï¼Œæˆ–è€…é™æ€æ–¹æ³•ï¼Œå•ä¾‹ç­‰ç­‰
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="data-class-çš„ä½¿ç”¨">data class çš„ä½¿ç”¨</h3>
<p>é»˜è®¤å®ç°äº†copyã€toString,è¿˜æœ‰componentNç­‰æ–¹æ³•</p>

<p>å®šä¹‰ä¸€ä¸ª data class ç±»</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>data class Country(var id: Int, var name: String, var continent: String)
</pre></td></tr></tbody></table></code></pre></div></div>

<p>ç¼–è¯‘å™¨è‡ªåŠ¨å®ç°çš„å‡½æ•°ä¸¾ä¾‹</p>

<ul>
  <li>
    <p>toString()</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>  var china = Country(0, "ä¸­å›½", "Asia")
  println(china) // Country(id=0, name=ä¸­å›½, continent=Asia)
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
  <li>
    <p>copy()</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>  var japan = china.copy(id = 1, name = "æ—¥æœ¬")
  println(japan) // Country(id=1, name=æ—¥æœ¬, continent=Asia)
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
  <li>
    <p>componentN()</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>  val (id, name, continent) = china
  println("$id --&gt; $nameï¼Œ$continent") // 0 --&gt; ä¸­å›½ï¼ŒAsia
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
</ul>

<h3 id="å‡½æ•°ç»§æ‰¿ä¸å®ç°å¤å†™ç­‰">å‡½æ•°ç»§æ‰¿ä¸å®ç°ã€å¤å†™ç­‰</h3>
<ul>
  <li>çˆ¶ç±»éœ€è¦openæ‰å¯ä»¥è¢«ç»§æ‰¿(kotliné»˜è®¤ä¸ºfinal)</li>
  <li>çˆ¶ç±»çš„æ–¹å¼ã€å±æ€§éœ€è¦openæ‰å¯ä»¥è¢«è¦†å†™</li>
  <li>æ¥å£ã€æ¥å£æ–¹æ³•ã€æŠ½è±¡ç±»é»˜è®¤ä¸ºopen</li>
  <li>è¦†å†™çˆ¶ç±»ï¼ˆæ¥å£ï¼‰æˆå‘˜éœ€è¦overrideå…³é”®å­—</li>
  <li>
    <p>æ³¨æ„ç»§æ‰¿ç±»æ—¶ï¼Œå®é™…ä¸Šæ˜¯è°ƒç”¨äº†çˆ¶ç±»çš„æ„é€ æ–¹æ³•</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre></td><td class="rouge-code"><pre>  abstract class Person(open val age: Int){
      abstract fun work()
  }
		
  class MaNong(age: Int): Person(age){
      override val age: Int
          get() = 0
      override fun work() {
          println("æˆ‘æ˜¯ç å†œï¼Œæˆ‘åœ¨å†™ä»£ç ")
      }
  }
		
  class Doctor(override val age: Int): Person(age){
      override fun work() {
          println("æˆ‘æ˜¯åŒ»ç”Ÿï¼Œæˆ‘åœ¨ç»™ç—…äººçœ‹ç—…")
      } }
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
</ul>

<h3 id="objectå…³é”®å­—">Objectå…³é”®å­—</h3>
<ul>
  <li>åªæœ‰ä¸€ä¸ªå®ä¾‹çš„ç±»</li>
  <li>ä¸èƒ½è‡ªå®šä¹‰æ„é€ å‡½æ•°</li>
  <li>å¯ä»¥å®ç°æ¥å£ã€ç»§æ‰¿çˆ¶ç±»</li>
  <li>
    <p>æœ¬è´¨ä¸Šå°±æ˜¯å•ä¾‹æ¨¡å¼æœ€åŸºæœ¬çš„å®ç°</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="rouge-code"><pre>  object TestKotlin
  ------------------------------è½¬åŒ–ä¸ºjavaä»£ç 
  public final class TestKotlin {
     public static final TestKotlin INSTANCE;
	
     private TestKotlin() {
     }
	
     static {
        TestKotlin var0 = new TestKotlin();
        INSTANCE = var0;
     }
  }
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
</ul>

<h3 id="companion-objectä¼´ç”Ÿå¯¹è±¡é™æ€å˜é‡æˆå‘˜è¿˜æœ‰-kotlinåŒ…çº§æˆå‘˜">companion objectä¼´ç”Ÿå¯¹è±¡ã€é™æ€å˜é‡æˆå‘˜è¿˜æœ‰ kotlinåŒ…çº§æˆå‘˜</h3>
<ul>
  <li>kotlinå…è®¸ä¸åœ¨ç±»ä¸‹é¢å†™æˆå‘˜å˜é‡è·Ÿæ–¹æ³•ï¼Œç§°ä¸ºåŒ…çº§åˆ«å¯¹è±¡/å‡½æ•°</li>
  <li>æ¯ä¸ªç±»å¯ä»¥å¯¹åº”æœ‰ä¸€ä¸ªä¼´ç”Ÿå¯¹è±¡companion object</li>
  <li>ä¼´ç”Ÿå¯¹è±¡companion objectä¸javaçš„staticé™æ€æ–¹æ³•/é™æ€æˆå‘˜çš„æ•ˆæœç±»ä¼¼ç›¸åŒã€‚</li>
  <li>kotlinä¸­çš„é™æ€æˆå‘˜è€ƒè™‘ç”¨åŒ…çº§å‡½æ•°ã€å˜é‡ä»£æ›¿</li>
  <li>
    <p>JvmFieldã€JvmStaticã€@file:JvmName(è‡ªå·±è‡ªå®šä¹‰çš„ç±»å)</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre></td><td class="rouge-code"><pre>  <span class="k">package</span> <span class="n">com</span><span class="p">.</span><span class="n">demo</span><span class="p">.</span><span class="n">dan</span><span class="p">.</span><span class="n">voice</span>
	
  <span class="n">val</span> <span class="n">Str</span> <span class="p">=</span> <span class="s2">"åŒ…çº§æˆå‘˜"</span>
  <span class="n">fun</span> <span class="n">packFun</span><span class="p">():</span> <span class="k">String</span> <span class="p">{</span>
      <span class="n">return</span> <span class="s2">"åŒ…çº§å‡½æ•°"</span>
  <span class="p">}</span>
	
  <span class="n">class</span> <span class="n">TestKotlin</span> <span class="p">{</span>
      <span class="n">companion</span> <span class="n">object</span> <span class="p">{</span>
          <span class="n">fun</span> <span class="n">compainFun</span><span class="p">():</span> <span class="k">String</span> <span class="p">{</span>
              <span class="n">return</span> <span class="s2">"ä¼´ç”Ÿå¯¹è±¡æ–¹æ³•"</span>
          <span class="p">}</span>
          <span class="n">var</span> <span class="n">Str</span> <span class="p">=</span> <span class="s2">"ä¼´ç”Ÿå¯¹è±¡æˆå‘˜"</span>
      <span class="p">}</span>
  <span class="p">}</span>


  <span class="p">//--------------</span><span class="err">åœ¨</span><span class="n">kotlin</span><span class="err">ä¸­è°ƒç”¨</span>
  <span class="n">fun</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
      <span class="n">println</span><span class="p">(</span><span class="n">Str</span><span class="p">)//</span><span class="err">åŒ…çº§æˆå‘˜</span>
      <span class="n">println</span><span class="p">(</span><span class="n">packFun</span><span class="p">())//</span><span class="err">åŒ…çº§å‡½æ•°</span>
      <span class="n">TestKotlin</span><span class="p">.</span><span class="n">Str</span>
      <span class="n">TestKotlin</span><span class="p">.</span><span class="n">compainFun</span><span class="p">()</span>
  <span class="p">}</span>
	
  <span class="p">//----------------</span><span class="err">åœ¨</span><span class="n">java</span><span class="err">ä¸­è°ƒç”¨</span>
  <span class="k">public</span> <span class="n">class</span> <span class="n">TestJava</span> <span class="p">{</span>
      <span class="k">public</span> <span class="n">static</span> <span class="n">void</span> <span class="n">main</span><span class="p">(</span><span class="k">String</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span> <span class="p">{</span>
          <span class="n">TestKotlin</span><span class="p">.</span><span class="n">Companion</span><span class="p">.</span><span class="n">compainFun</span><span class="p">();</span>
          <span class="n">TestKotlin</span><span class="p">.</span><span class="n">Companion</span><span class="p">.</span><span class="n">getStr</span><span class="p">();</span>
      <span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
</ul>

<p>å¯ä»¥çœ‹åˆ°ä¸Šé¢javaè°ƒç”¨kotlinçš„ä»£ç å¹¶ä¸åƒæˆ‘ä»¬javaè°ƒç”¨é™æ€å¯¹è±¡ä¸€æ ·ï¼ˆä¸­é—´å¤šäº†å±‚Companionï¼‰ã€‚
ä¸Šé¢çš„javaè°ƒç”¨Kotlinå¯ä»¥åœ¨ä¼´ç”Ÿå¯¹è±¡ä¸­å¢åŠ å¯¹åº”çš„æ³¨è§£ï¼š</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre></td><td class="rouge-code"><pre>	å‡½æ•°ä¸ŠåŠ  @JvmStaticï¼Œ
	å˜é‡ä¸ŠåŠ @JvmField
	å®ç°ç±»ä¼¼è°ƒç”¨javaé™æ€æˆå‘˜/æ–¹æ³•

	class TestKotlin {
	    companion object {
	      @JvmStatic
	        fun compainFun(): String {
	            return "ä¼´ç”Ÿå¯¹è±¡æ–¹æ³•"
	        }
	        @JvmField
	        var Str = "ä¼´ç”Ÿå¯¹è±¡æˆå‘˜"
	    }
	}
	
	//----------------åœ¨javaä¸­è°ƒç”¨
	public class TestJava {
	    public static void main(String[] args) {
	        TestKotlin.compainFun();
	        String str = TestKotlin.Str;
	    }
	}
</pre></td></tr></tbody></table></code></pre></div></div>

<h4 id="javaæ€ä¹ˆè°ƒç”¨kotlinçš„åŒ…çº§åˆ«å¯¹è±¡å‘¢">javaæ€ä¹ˆè°ƒç”¨kotlinçš„åŒ…çº§åˆ«å¯¹è±¡å‘¢ï¼Ÿï¼Ÿï¼Ÿ</h4>
<p>ç­”æ¡ˆï¼šå¯ä»¥ä½¿ç”¨@file:JvmName(è‡ªå·±è‡ªå®šä¹‰çš„ç±»å)</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre></td><td class="rouge-code"><pre>	<span class="p">@</span><span class="n">file</span><span class="p">:</span><span class="n">JvmName</span><span class="p">(</span><span class="s2">"TestKotlin1"</span><span class="p">)</span>
	<span class="k">package</span> <span class="n">com</span><span class="p">.</span><span class="n">demo</span><span class="p">.</span><span class="n">dan</span><span class="p">.</span><span class="n">imoc_voice</span>
	
	<span class="n">val</span> <span class="n">Str</span> <span class="p">=</span> <span class="s2">"åŒ…çº§æˆå‘˜"</span>
	<span class="n">fun</span> <span class="n">packFun</span><span class="p">():</span> <span class="k">String</span> <span class="p">{</span>
	    <span class="n">return</span> <span class="s2">"åŒ…çº§å‡½æ•°"</span>
	<span class="p">}</span>
	<span class="err">å¤åˆ¶ä»£ç </span><span class="n">java</span><span class="err">è°ƒç”¨ï¼š</span>
	<span class="k">public</span> <span class="n">class</span> <span class="n">TestJava</span> <span class="p">{</span>
	    <span class="k">public</span> <span class="n">static</span> <span class="n">void</span> <span class="n">main</span><span class="p">(</span><span class="k">String</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span> <span class="p">{</span>
	        <span class="n">TestKotlin1</span><span class="p">.</span><span class="n">getStr</span><span class="p">();</span>
	        <span class="n">TestKotlin1</span><span class="p">.</span><span class="n">packFun</span><span class="p">();</span>
	    <span class="p">}</span>
	<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="parcelize">@Parcelize</h3>

<p>Androidä¸­çš„å¯¹è±¡éœ€è¦ç±»ç»§æ‰¿Parcelableæ¥å£æ¥å®ç°åºåˆ—åŒ–ï¼Œ</p>

<p>ä¼ ç»Ÿçš„æ ‡å‡†æ–¹æ³•ã€‚è®©Personç±»ç»§æ‰¿Parcelableæ¥å£å¹¶æŒ‰ç…§Android Studioçš„è¦æ±‚å®ç°ç›¸å…³API</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre></td><td class="rouge-code"><pre>data class Person(val name: String, val age: Int, val email: String, val phone: Long) : Parcelable {
    constructor(parcel: Parcel) : this(
        parcel.readString(),
        parcel.readInt(),
        parcel.readString(),
        parcel.readLong())

    override fun writeToParcel(parcel: Parcel, flags: Int) {
        parcel.writeString(name)
        parcel.writeInt(age)
        parcel.writeString(email)
        parcel.writeLong(phone)
    }

    override fun describeContents(): Int {
        return 0
    }

    companion object CREATOR : Parcelable.Creator&lt;Person&gt; {
        override fun createFromParcel(parcel: Parcel): Person {
            return Person(parcel)
        }

        override fun newArray(size: Int): Array&lt;Person?&gt; {
            return arrayOfNulls(size)
        }
    }
}
</pre></td></tr></tbody></table></code></pre></div></div>

<p>build.gradleæ·»åŠ æ’ä»¶</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>apply plugin: 'kotlin-android-extensions'
</pre></td></tr></tbody></table></code></pre></div></div>

<p>build.gradleä¸‹androidé…ç½®æ·»åŠ </p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>androidExtensions {
    experimental = true
}
</pre></td></tr></tbody></table></code></pre></div></div>

<p>ä½¿ç”¨@Parcelizeä¹‹å</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre>@Parcelize
data class PersonParcelize(val name: String, 
                           val age: Int, 
                           val email: String, 
                           val phone: Long) : Parcelable
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="viewonclicklistener">View.OnClickListener</h3>
<p>Kotlinå¯¹Lambdaçš„å®Œç¾æ”¯æŒï¼Œè®©æˆ‘ä»¬å†™å•å‡½æ•°æ—¶æœ‰äº†æé€Ÿçš„æå‡ã€‚</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre></td><td class="rouge-code"><pre>åœ¨Javaä¸­ï¼Œå¯¹Viewæ·»åŠ ä¸€ä¸ªç‚¹å‡»äº‹ä»¶æ—¶æ˜¯è¿™æ ·å†™çš„ï¼š
view.setOnClickListener(new View.OnClickListener() {
    @Override
    public void onClick(View v) {
        v.setVisibility(View.VISIBLE);
        ...
    }
});

è€Œåœ¨Kotlinä¸­æˆ‘ä»¬ä½¿ç”¨å®ƒæ—¶ï¼Œå¯ä»¥è¿™æ ·ï¼š
view.setOnClickListener(object :View.OnClickListener{
    override fun onClick(v: View?) {
        v.visibility = View.VISIBLE    
        ...
    }
})
</pre></td></tr></tbody></table></code></pre></div></div>

<p>æ ¹æ®lambdaè¡¨è¾¾å¼è§„åˆ™:</p>

<ul>
  <li>Lambdaè¡¨è¾¾ä¸€èˆ¬ä½¿ç”¨â€œ{ }â€åŒ…å›´ã€‚</li>
  <li>å®ƒçš„å‚æ•°ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰åœ¨â€œ-&gt;â€å‰å®šä¹‰ï¼Œå‚æ•°ç±»å‹å¯èƒ½æ˜¯çœç•¥çš„ã€‚</li>
  <li>å‡½æ•°ä½“è·Ÿåœ¨â€œ-&gt;â€åé¢ã€‚</li>
</ul>

<p>æˆ‘ä»¬å¯æŠŠä¸Šé¢çš„ä»£ç ç®€åŒ–ä¸ºï¼š</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre></td><td class="rouge-code"><pre>view.setOnClickListener({ v -&gt;
    v.visibility = View.VISIBLE    
    ...
}) æ ¹æ®å¦‚æœå‚æ•°ä¸ºå‡½æ•°å¹¶ä¸”æ˜¯æœ€åä¸€ä¸ªå‚æ•°ï¼Œå¯ä»¥å°†å‚æ•°ç§»åˆ°æ‹¬å·å¤–é¢ã€‚

view.setOnClickListener() { v -&gt;
    v.visibility = View.VISIBLE    
    ...
} æ ¹æ®ç§»åŠ¨åˆ°æ‹¬å·å¤–é¢ä¹‹åå¦‚æœæ‹¬å·å†…æ²¡æœ‰å‚æ•°ï¼Œæ‹¬å·å¯ä»¥çœç•¥ä¸å†™ã€‚ä½ è§åˆ°çš„æ˜¯è¿™ä¸ªã€‚

view.setOnClickListener { v -&gt;
    v.visibility = View.VISIBLE    
    ...
} æ ¹æ®è‹¥å‡½æ•°å‚æ•°å¯¹åº”çš„å‡½æ•°åªæœ‰ä¸€ä¸ªå‚æ•°ï¼Œåœ¨ä½¿ç”¨æ—¶ï¼Œå¯ä»¥çœç•¥å‚æ•°å®šä¹‰ï¼Œç›´æ¥ä½¿ç”¨â€œitâ€ä»£æ›¿å‚æ•°ï¼Œä½ æœ€ç»ˆçœ‹åˆ°çš„æ˜¯è¿™ä¸ªã€‚

view.setOnClickListener {
    it.visibility = View.VISIBLE
}
</pre></td></tr></tbody></table></code></pre></div></div>

:ET